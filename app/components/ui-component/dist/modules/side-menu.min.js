/**
 * ui-component
 * @version v0.2.21 - 2015-02-03
 * @link https://github.corp.ebay.com/opsins/ui-component
 * @author Martin Liu (hualiu@ebay.com)
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"use strict";angular.module("ui-component.side-menu",["ui-component.deps"]).directive("uiSideMenu",["$q","$location","$http","$window","$timeout","$rootScope",function(e,i,t,n,o,s){function r(e,i,t,n,o){var s,r;return"undefined"!=typeof Piwik&&null!==Piwik?(r=("https:"===document.location.protocol?"https":"http")+"://opspiwik.corp.ebay.com/piwik/",s=Piwik.getTracker(""+r+"/piwik.php",o),s.setCustomVariable(1,"User",e,"visit"),s.setCustomVariable(2,"App",i,"page"),s.setCustomVariable(3,"PageName",t,"page"),s.setCustomVariable(4,"Prod",n,"page"),s.trackPageView(),s.enableLinkTracking()):void 0}function a(e){e.triggerMinify=function(){e.minified=!e.minified,sessionStorage.setItem(c,e.minified),s.$emit("ui-component.side-menu.trigger-minified",e.minified)},e.setActive=function(i){if(e.active!=i.id){if(e.active=i.id,sessionStorage.setItem(l,e.active),i.notReady)e.mode="comingSoon";else if(i.iframe){e.mode="iframe";var t=document.querySelector("iframe.capacity-dash");t.src=i.iframe.src}else e.mode=null;s.user&&i.piwik&&r(s.user.nt,i.piwik.app,i.piwik.page,i.piwik.prod,i.piwik.siteId),i.showSubMenu=!0}else i.showSubMenu=!i.showSubMenu},e.isActive=function(i){var t=null;if(e.active){var n=e.active.split("_");n.length>1&&(t=n[0]==i.id)}return t||e.active==i.id},e.isExpand=function(i){var t=null;if(e.active){var n=e.active.split("_");n.length>1&&(t=n[0]==i.id)}return t||i.showSubMenu},e.processUrl=function(e){if(e&&!i.$$html5&&0==e.indexOf("/")){var t=e.indexOf(location.pathname);t>-1&&(e=e.replace(location.pathname,"#!"))}return e}}function u(i){var n=e.defer(),o=sessionStorage.getItem(m);if(o)i.list=angular.fromJson(o),n.resolve();else{var s;s=i.sourceUrl?i.sourceUrl:"undefined"!=typeof Config&&Config.uri&&Config.uri.api?Config.uri.api+"uicomponent/getsidemenu":"https://doe.corp.ebay.com/api/uicomponent/getsidemenu",t({method:"GET",url:s}).success(function(e){if(e&&e.length){var t=e[0].list;i.list=angular.fromJson(t),t&&sessionStorage.setItem(m,t),n.resolve()}})}return n.promise}var c="opsins_side_menu_minified",l="opsins_side_menu_active",m="opsins_side_menu_List_Load";return{restrict:"EAC",templateUrl:"side-menu/side-menu.tpl.html",scope:{sourceUrl:"="},transclude:!0,link:function(e){function t(t){if(o)t.id==o&&e.setActive(t);else{var n=i.absUrl().replace(/\?.*/,""),s=location.pathname;(n==t.url||s==t.url)&&e.setActive(t)}}function n(e){angular.forEach(e,function(e){t(e),e.submenu&&e.submenu.length&&n(e.submenu)})}a(e),e.minified="true"==sessionStorage.getItem(c);var o=sessionStorage.getItem(l);u(e).then(function(){n(e.list),e.active||e.setActive(e.list[0])})}}}]);
//# sourceMappingURL=side-menu.min.js.map